% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/de.R
\name{emphasis_de}
\alias{emphasis_de}
\title{Fit the PD diversification model using Differential Evolution}
\usage{
emphasis_de(
  brts,
  num_iterations,
  num_points,
  max_missing,
  sd_vec,
  lower_bound,
  upper_bound,
  maxN = 10,
  max_lambda,
  disc_prop = 0.5,
  verbose = FALSE,
  num_threads = 1
)
}
\arguments{
\item{brts}{Numeric vector of branching times for the observed tree.}

\item{num_iterations}{Number of DE iterations.}

\item{num_points}{Number of particles (parameter proposals) per iteration.}

\item{max_missing}{Maximum number of missing lineages in augmentation.}

\item{sd_vec}{Initial standard deviation vector for particle perturbation (one per parameter).}

\item{lower_bound}{Numeric vector of lower bounds for each parameter.}

\item{upper_bound}{Numeric vector of upper bounds for each parameter.}

\item{maxN}{Maximum number of augmentation tries per particle. Defaults to 10.}

\item{max_lambda}{Maximum speciation rate.}

\item{disc_prop}{Proportion of particles to discard each iteration. Defaults to 0.5.}

\item{verbose}{If TRUE, print iteration progress. Defaults to FALSE.}

\item{num_threads}{Number of parallel threads. Defaults to 1.}
}
\value{
A list with:
\itemize{
  \item \code{parameters} list of particle data frames per iteration;
  \item \code{time} total computation time;
  \item \code{fhatdiff} SD of log-likelihood estimates per iteration;
  \item \code{minloglik} minimum log-likelihood per iteration;
  \item \code{meanloglik} mean log-likelihood per iteration;
  \item \code{min_pars} best parameter estimates per iteration;
  \item \code{mean_pars} mean parameter estimates per iteration;
  \item \code{obtained_estim} final parameter estimates (column means of \code{min_pars}).
}
}
\description{
Uses a Differential Evolution (DE) particle-filter algorithm to estimate
the parameters of the phylogenetic diversity (PD) diversification model.
Each iteration resamples and perturbs particles, evaluating the
log-likelihood via importance sampling.
}
\examples{
\dontrun{
  library(ape)
  tree <- sim_tree_pd_cpp(c(0.1, 0.5, -0.01, 0.01), max_t = 1)
  fit <- emphasis_de(
    brts        = tree$brts,
    num_iterations = 20,
    num_points  = 100,
    max_missing = 1000,
    sd_vec      = c(0.1, 0.5, 0.01, 0.01),
    lower_bound = c(0, 0, -0.1, -0.1),
    upper_bound = c(0.5, 2, 0.1, 0.1),
    max_lambda  = 500
  )
  fit$obtained_estim
}
}
