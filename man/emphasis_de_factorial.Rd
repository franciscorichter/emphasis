% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/de.R
\name{emphasis_de_factorial}
\alias{emphasis_de_factorial}
\title{Fit the PD diversification model using Differential Evolution (factorial variant)}
\usage{
emphasis_de_factorial(
  brts,
  num_iterations,
  num_points,
  max_missing,
  sd_vec,
  lower_bound,
  upper_bound,
  maxN = 10,
  max_lambda,
  disc_prop = 0.5,
  verbose = FALSE,
  num_threads = 1
)
}
\arguments{
\item{brts}{Numeric vector of branching times for the observed tree.}

\item{num_iterations}{Number of DE iterations.}

\item{num_points}{Number of particles per iteration.}

\item{max_missing}{Maximum number of missing lineages in augmentation.}

\item{sd_vec}{Initial standard deviation vector for particle perturbation.}

\item{lower_bound}{Numeric vector of lower bounds for each parameter.}

\item{upper_bound}{Numeric vector of upper bounds for each parameter.}

\item{maxN}{Maximum augmentation tries per particle. Defaults to 10.}

\item{max_lambda}{Maximum speciation rate.}

\item{disc_prop}{Proportion of particles discarded each iteration. Defaults to 0.5.}

\item{verbose}{If TRUE, show a progress bar. Defaults to FALSE.}

\item{num_threads}{Number of parallel threads. Defaults to 1.}
}
\value{
A list similar to \code{\link{emphasis_de}}, additionally containing
\code{logf_grid} and \code{logg_grid} (per-iteration log importance weights).
}
\description{
Variant of \code{\link{emphasis_de}} that uses the factorial C++ grid evaluator,
returning additional per-particle log importance weight vectors per iteration.
}
\examples{
\dontrun{
  library(ape)
  tree <- sim_tree_pd_cpp(c(0.1, 0.5, -0.01, 0.01), max_t = 1)
  fit <- emphasis_de_factorial(
    brts        = tree$brts,
    num_iterations = 20,
    num_points  = 100,
    max_missing = 1000,
    sd_vec      = c(0.1, 0.5, 0.01, 0.01),
    lower_bound = c(0, 0, -0.1, -0.1),
    upper_bound = c(0.5, 2, 0.1, 0.1),
    max_lambda  = 500
  )
}
}
